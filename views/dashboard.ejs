<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>DashBoard</title>
        
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
        </script>
        
        <script 
            src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"> 
        </script> 

        <!--  
        <link rel="stylesheet" type="text/css" href="./stylesheets/index.css" media="screen" />
        -->

        <style> 
            h1 {
                color: rgb(255, 255, 255);
                font-family: verdana;
                font-size: 150%;
                border: 2px solid rgb(30, 32, 32);
                padding: 30px;
                background-color: #04AA6D;
            }
            div {
              width: 500px;
              height: 100px;
              background-color: #04AA6D;
              animation-name: example;
              animation-duration: 10s;
              
              animation-iteration-count: 100;
            }
            
            @keyframes example {
              from {background-color: #04AA6D;}
              to {background-color: #04AA6D;}
              
            }

        </style>
       
    </head>

    <body>

        <script src="/socket.io/socket.io.js"></script>

        
        <script 
            src="http://code.jquery.com/jquery-latest.min.js"> 
        </script> 


        <h1>DashBoard</h1>
        <hr>
        
        <canvas id="myChart" style="width:100%;max-width:500px"></canvas>

        <script>

            
            var xValues = ['joining', 'cutoff', 'complaint', 'service', 'overall'];
            var yValues = [msg[0], msg[1], msg[2], msg[3], msg[4]];
            var barColors = ["red", "green","blue","orange","brown"];

            new Chart("myChart", {
            type: "bar",
            data: {
                labels: xValues,
                datasets: [{
                backgroundColor: barColors,
                data: yValues
                }]
            },
            options: {
                legend: {display: false},
                title: {
                display: true,
                text: "topics"
                }
            }
            });
            

        </script>
        
        

        <canvas id="myChart2" style="width:100%;max-width:500px"></canvas>
        
        <script>

            
            var xValues2 = ['8:00', '9:00', '10:00', '11:00', '12:00',
                            '13:00', '14:00', '15:00', '16:00', '17:00',
                            '18:00', '19:00', '20:00'];

            new Chart("myChart2", {
            type: "line",
            data: {
                labels: xValues2,
                datasets: [{ 
                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                borderColor: "blue",
                fill: false
                }]
            },
            options: {
                legend: {display: false},
                title: {
                display: true,
                text: "Daily Calls"
                }
            }
            });
            

        </script>


        <div id="div"></div>
        


        <ul id="messages"></ul>
        <form id="form" action="">
          <input id="input" autocomplete="off" /><button>Send</button>
        </form>

        <script>
            
            var socket = io();

            var messages = document.getElementById('messages');
            var form = document.getElementById('form');
            var input = document.getElementById('input');

            var div = document.getElementById('div');

            
            
            div.addEventListener("webkitAnimationIteration", function(e) {    
                e.preventDefault();
                if (/*input.value*/true) {
                socket.emit('chat message', input.value);
                input.value = '';
                }
            });

            socket.on('chat message', function(msg) {

                var xValues = ['joining', 'cutoff', 'complaint', 'service', 'overall'];
                var yValues = [msg[0], msg[1], msg[2], msg[3], msg[4]];
                var barColors = ["red", "green","blue","orange","brown"];

                
                
                new Chart("myChart", {
                type: "bar",
                data: {
                    labels: xValues,
                    datasets: [{
                    backgroundColor: barColors,
                    data: yValues
                    }]
                },
                options: {
                    legend: {display: false},
                    title: {
                    display: true,
                    text: "topics"
                    }
                }
                });
                


                var xValues2 = ['8:00', '9:00', '10:00', '11:00', '12:00',
                            '13:00', '14:00', '15:00', '16:00', '17:00',
                            '18:00', '19:00', '20:00'];

                new Chart("myChart2", {
                type: "line",
                data: {
                    labels: xValues2,
                    datasets: [{ 
                    data: [0, 0, msg[0], msg[1], msg[2], msg[3], 0, 0, 0, 0, 0, 0, 0],
                    borderColor: "blue",
                    fill: false
                    }]
                },
                options: {
                    legend: {display: false},
                    title: {
                    display: true,
                    text: "Daily Calls"
                    }
                }
                });


                
                /*
                var item = document.createElement('li');
                item.textContent = msg;
                messages.appendChild(item);
                window.scrollTo(0, document.body.scrollHeight);
                */
            });
        </script>

    </body>
</html>